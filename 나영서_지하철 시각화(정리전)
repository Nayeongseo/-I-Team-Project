!sudo apt-get install -y fonts-nanum
!sudo fc-cache -fv
!rm~/.cache/matplotlib -rf


import networkx as nx
import matplotlib.pyplot as plt
import matplotlib.font_manager as fm

# 나눔 폰트 설치
!apt-get update -qq
!apt-get install fonts-nanum* -qq

# 설치된 폰트 확인
font_list = fm.findSystemFonts(fontpaths=None, fontext='ttf')
font_list

# 나눔 폰트 설정
plt.rc('font', family='NanumGothic')

# 호선별로 저장한 txt 파일 불러오기 및 저장
subway_files = [
    open('1호선 노선.txt', 'r'),
    open('2호선 노선.txt', 'r'),
    open('3호선 노선.txt', 'r'),
    open('4호선 노선.txt', 'r'),
    open('5호선 노선.txt', 'r')
]

# 노선들을 list로 저장
subway_lines = [file.read().split(' - ') for file in subway_files]

# 공백 제거 후 dictionary로 변환
subway_dicts = [dict(zip(map(str.strip, line), range(1, len(line)))) for line in subway_lines]

# 호선 정보 추가
for line, subway_dict in zip(range(1, 6), subway_dicts):
    subway_dict['line'] = line

# 각 노선을 정렬한 dictionary 생성
subway_sort_dicts = [dict.fromkeys(sorted(subway_dict.keys()), str(line)) for line, subway_dict in zip(range(1, 6), subway_dicts)]

# 호선 정보 추가
for subway_sort_dict in subway_sort_dicts:
    subway_sort_dict['line'] = int(subway_sort_dict.get(next(iter(subway_sort_dict))))

# 출력
for i, subway_dict in enumerate(subway_dicts, start=1):
    print(f"Line {i}:", subway_dict)

for i, subway_sort_dict in enumerate(subway_sort_dicts, start=1):
    print(f"Sorted Line {i}:", subway_sort_dict)

# 한글 폰트 설정
plt.rc('font', family='sans-serif')

def create_subway_graph(subway_lines):
    G = nx.Graph()
    for line in subway_lines:
        stations = list(line.keys())
        for i in range(len(stations) - 1):
            G.add_edge(stations[i], stations[i + 1])
    return G

# 그래프 생성
G = create_subway_graph([subway_sort_dict_line1, subway_sort_dict_line2,
                         subway_sort_dict_line3, subway_sort_dict_line4, subway_sort_dict_line5])

# 호선별 색상 지정
colors = ['red', 'blue', 'green', 'orange', 'purple']

# 그래프 시각화
plt.figure(figsize=(15, 10))
pos = nx.spring_layout(G, seed=42)

for i, line_dict in enumerate([subway_sort_dict_line1, subway_sort_dict_line2,
                               subway_sort_dict_line3, subway_sort_dict_line4, subway_sort_dict_line5]):
    # 호선별 노드 추출
    nodes = list(line_dict.keys())
    # 호선별 색상 적용
    nx.draw_networkx_nodes(G, pos, nodelist=nodes, node_size=300, node_color=colors[i])

nx.draw_networkx_edges(G, pos, edge_color='black', width=2)
nx.draw_networkx_labels(G, pos, font_size=10, font_family='sans-serif')  # 한글 폰트 적용
plt.title('지하철 노선도')
plt.axis('off')
plt.show()

